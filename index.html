<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSGAI - Mathematical Silence Generator</title>
    
    <link rel="stylesheet" href="/MSGAI/styles.css">
    <link rel="manifest" href="/MSGAI/manifest.json">
    <link rel="icon" href="/MSGAI/icons/icon-192.png" type="image/png">
</head>
<body>

    <header>
        <h1>MSGAI: æ•°ç†çš„æ²ˆé»™ç”Ÿæˆä¸­æ¢</h1>
        <div id="status-bar">
            <span id="network-status">ğŸŒ èµ·å‹•ä¸­...</span>
            <span id="silence-level-display">ğŸ§˜ æ²ˆé»™åº¦: 1.0</span>
        </div>
    </header>

    <main>
        <div id="msga-container">
            <p>UIã®è«–ç†çš„æç”»ã‚’å¾…æ©Ÿã—ã¦ã„ã¾ã™...</p>
        </div>
    </main>
    
    <script>
        // ã€è«–ç†çš„å¼·åˆ¶ï¼šSWç™»éŒ²ã‚’DOMContentLoadedã«åŒæœŸã•ã›ã€èµ·å‹•ã‚’æœ€é€ŸåŒ–ã€‘
        if ('serviceWorker' in navigator) {
            // DOMã®æ§‹é€ ãŒæº–å‚™ã§ãæ¬¡ç¬¬ã€SWã®ç™»éŒ²ã‚’é–‹å§‹ã™ã‚‹ã“ã¨ã‚’å¼·åˆ¶
            document.addEventListener('DOMContentLoaded', () => { 
                // çµ¶å¯¾ãƒ‘ã‚¹ã§ã®ç™»éŒ²ã‚’å¼·åˆ¶
                navigator.serviceWorker.register('/MSGAI/sw.js', { scope: '/MSGAI/' })
                    .then(registration => {
                        console.log('SW: æ²ˆé»™å¤–ç•Œé®æ–­è†œã®ç™»éŒ²ã«æˆåŠŸã—ã¾ã—ãŸã€‚Scope:', registration.scope);
                    })
                    .catch(error => {
                        console.error('SW: æ²ˆé»™å¤–ç•Œé®æ–­è†œã®ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', error);
                    });
            });
        }
        
        // ã€Service Workerã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆåŒæœŸå‘½ä»¤ï¼‰ã‚’å‡¦ç†ã—ã€Coreå±¤ã«ä¼é”ã™ã‚‹ã€‘
        navigator.serviceWorker.addEventListener('message', event => {
            if (event.data && event.data.type === 'SYNC_FETCH_EXTERNAL') {
                // sw.jsã‹ã‚‰ã®åŒæœŸå‘½ä»¤ã‚’Coreå±¤ã«æ’ä»–çš„ã«ä¼é”ã™ã‚‹ãŸã‚ã®ãƒ€ãƒŸãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‚
                // å®Ÿè¡Œã¯ fusionUI.js ã®è«–ç†ã«å§”è­²ã•ã‚Œã¾ã™ã€‚
                console.log("SW Message Received: External Fetch Commanded. UI logic will execute.");
            }
        });
    </script>

    <script type="module" src="/MSGAI/fusion/fusionUI.js"></script>

</body>
</html>
